<%# Manage Guests Modal (Screenshot 2: Search, Filters, List) %>

<%# Use the same participants variable from the event show page %>
<% participants = @event.participations.includes(:user).order("users.name ASC") %>

<div class="manage-guests-modal-backdrop" id="manage-guests-modal" data-controller="modal" data-action="click->modal#closeBackground">
  <div class="manage-guests-modal-content" data-modal-target="container">

    <%# Modal Header %>
    <header class="modal-header">
      <button class="back-btn" data-action="modal#close"><i class="fa-solid fa-arrow-left"></i></button>
      <h1 class="centered-title">Manage Guests</h1>
    </header>

    <%# Search and Filter %>
    <div class="guest-management-tools">
      <div class="search-box">
        <input type="search" placeholder="Find a guest..." class="form-control">
      </div>
      <div class="filter-controls">
        <select class="form-select status-filter">
          <option value="all">Status</option>
          <option value="attending">Attending</option>
          <option value="maybe">Maybe</option>
          <option value="declined">Declined</option>
        </select>

        <div class="status-tabs">
          <button class="status-tab active">ğŸ‘ Going <%= participants.where(status: 'going').count %></button>
          <button class="status-tab">ğŸ¤” Maybe <%= participants.where(status: 'maybe').count %></button>
          <button class="status-tab">â­ Interested <%= participants.where(status: 'interested').count %></button>
        </div>
      </div>
    </div>

    <%# Guest Full List %>
    <ul class="guest-full-list">
      <% participants.each do |participation| %>
        <li class="guest-list-item">
          <div class="guest-info">
            <%# Avatar/Profile Picture %>
            <div class="guest-avatar" style="background-color: #<%= Digest::MD5.hexdigest(participation.user.email)[0..5] %>;">
              <%= participation.user.name.first.upcase %>
            </div>
            <div class="guest-details">
              <span class="guest-name-full"><%= participation.user.name %></span>
              <% if participation.extra_guests && participation.extra_guests > 0 %>
                <small class="extra-guests-count"> and <%= participation.extra_guests %> more</small>
              <% end %>
            </div>
          </div>

          <%# Status Dropdown (Right side) %>
          <select class="form-select guest-status-select">
            <option value="going" <%= 'selected' if participation.status == 'going' %>>ğŸ‘ Going</option>
            <option value="maybe" <%= 'selected' if participation.status == 'maybe' %>>ğŸ¤” Maybe</option>
            <option value="declined" <%= 'selected' if participation.status == 'declined' %>>ğŸ‘ Declined</option>
          </select>
        </li>
      <% end %>
    </ul>
  </div>
</div>
