<%# Manage Guests Modal - Uses same design as RSVP modal %>

<% participants = @event.participations.includes(:user).order("users.name ASC") %>

<div class="rsvp-modal-overlay manage-guests-overlay is-hidden" id="manage-guests-modal">
  <div class="rsvp-modal manage-guests-modal">
    <button type="button" class="rsvp-modal-close manage-guests-close" aria-label="Close">&times;</button>

    <h2 class="manage-guests-title">Manage Guests</h2>

    <%# Search and Filter %>
    <div class="manage-guests-tools">
      <div class="manage-guests-search">
        <input type="search" placeholder="Find a guest..." class="rsvp-input">
      </div>

      <div class="manage-guests-filter">
        <select class="rsvp-input status-filter-select">
          <option value="all">All Statuses</option>
          <option value="going">Going</option>
          <option value="maybe">Maybe</option>
          <option value="not_going">Not going</option>
        </select>
      </div>

      <div class="manage-guests-status-tabs">
        <button type="button" class="status-tab active" data-status="going">
          <span class="status-emoji">ğŸ‘</span>
          <span class="status-label">Going</span>
          <span class="status-count"><%= participants.where(status: 'going').count %></span>
        </button>
        <button type="button" class="status-tab" data-status="maybe">
          <span class="status-emoji">ğŸ¤”</span>
          <span class="status-label">Maybe</span>
          <span class="status-count"><%= participants.where(status: 'maybe').count %></span>
        </button>
        <button type="button" class="status-tab" data-status="not_going">
          <span class="status-emoji">ğŸ‘</span>
          <span class="status-label">Not going</span>
          <span class="status-count"><%= participants.where(status: ['not_going', 'declined']).count %></span>
        </button>
      </div>
    </div>

    <%# Guest Full List %>
    <ul class="manage-guests-list">
      <% participants.each do |participation| %>
        <li class="manage-guests-item">
          <div class="guest-info">
            <div class="guest-avatar" style="background-color: #<%= Digest::MD5.hexdigest(participation.user.email)[0..5] %>;">
              <%= participation.user.name.first.upcase %>
            </div>
            <div class="guest-details">
              <span class="guest-name"><%= participation.user.name %></span>
              <% if participation.extra_guests && participation.extra_guests > 0 %>
                <small class="extra-guests-badge">+<%= participation.extra_guests %></small>
              <% end %>
            </div>
          </div>

          <select class="guest-status-select">
            <option value="going" <%= 'selected' if participation.status == 'going' %>>ğŸ‘ Going</option>
            <option value="maybe" <%= 'selected' if participation.status == 'maybe' %>>ğŸ¤” Maybe</option>
            <option value="not_going" <%= 'selected' if participation.status == 'not_going' || participation.status == 'declined' %>>ğŸ‘ Not going</option>
          </select>
        </li>
      <% end %>
    </ul>
  </div>
</div>
